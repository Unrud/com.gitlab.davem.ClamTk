From 7d796a27dd26e124967998119ee5b5f4e76f6581 Mon Sep 17 00:00:00 2001
From: Ryan Gonzalez <rymg19@gmail.com>
Date: Sat, 7 Sep 2019 13:23:06 -0500
Subject: [PATCH 4/4] Remove app auto-update functionality for the Flatpak

---
 lib/Settings.pm | 15 ---------------
 lib/Startup.pm  | 15 ++-------------
 2 files changed, 2 insertions(+), 28 deletions(-)

diff --git a/lib/Settings.pm b/lib/Settings.pm
index a967a2e..95a61c3 100644
--- a/lib/Settings.pm
+++ b/lib/Settings.pm
@@ -97,21 +97,6 @@ sub show_window {
         }
     );
 
-    $option = Gtk3::CheckButton->new_with_label(
-        _( 'Check for updates to this program' ) );
-    $option->set_tooltip_text(
-        _( 'Check online for application and signature updates' ) );
-    $option->set_active( TRUE ) if ( $prefs{ GUICheck } );
-    $grid->attach( $option, 0, 4, 1, 1 );
-    $option->signal_connect(
-        toggled => sub {
-            my $btn = shift;
-            ClamTk::Prefs->set_preference( 'GUICheck', $btn->get_active
-                ? 1
-                : 0 );
-        }
-    );
-
     my $infobar = Gtk3::InfoBar->new;
     #$box->pack_start( $infobar, FALSE, FALSE, 10 );
     $infobar->set_message_type( 'other' );
diff --git a/lib/Startup.pm b/lib/Startup.pm
index 52e7bf3..fae61b8 100644
--- a/lib/Startup.pm
+++ b/lib/Startup.pm
@@ -21,14 +21,7 @@ use Time::Piece;
 $| = 1;
 
 sub startup_check {
-    my ( $sigs_outdated, $gui_outdated );
-
-    # If the user wants a GUI update check on startup:
-    if ( ClamTk::Prefs->get_preference( 'GUICheck' ) ) {
-        if ( check_gui() ) {
-            $gui_outdated++;
-        }
-    }
+    my $sigs_outdated;
 
     # Check AV date - 4 days and sound the alarm
     my $t        = localtime;
@@ -44,12 +37,8 @@ sub startup_check {
         $sigs_outdated++;
     }
 
-    if ( $sigs_outdated && $gui_outdated ) {
-        return 'both';
-    } elsif ( $sigs_outdated ) {
+    if ( $sigs_outdated ) {
         return 'sigs';
-    } elsif ( $gui_outdated ) {
-        return 'gui';
     } else {
         return 0;
     }
-- 
2.21.0

